[Unit]
Description=VPSie Load Balancer Control Plane Agent
Documentation=https://github.com/vpsie/vpsie-loadbalancer
After=network-online.target envoy.service
Wants=network-online.target
Requires=envoy.service

[Service]
Type=simple
User=root
Group=root
ExecStart=/usr/local/bin/vpsie-lb-agent --config /etc/vpsie-lb/agent.yaml
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/etc/envoy /var/log/envoy /var/run

# Resource limits
LimitNOFILE=65536
LimitNPROC=512

# Environment
Environment="VPSIE_API_KEY_FILE=/etc/vpsie-lb/api-key"

[Install]
WantedBy=multi-user.target
